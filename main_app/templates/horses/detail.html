{% extends 'base.html' %}
{% load static %}

{% block head %}
<link rel="stylesheet" href="{% static 'css/horses/horse_detail.css' %}" />
{% endblock head %}

{% block content %}
<section class="horse-container">
    <div class="horse-img">
        <!-- <img src="{% static 'images/' %}" alt=""> -->
    </div>
    <div class="horse-details">
        <h1>{{ horse.name }}</h1>

        {% if horse.age > 0 %}
        <h2>A {{ horse.age }} year old {{ horse.breed }} </h2>
        {% else %}
        <h2>A {{ horse.breed }} foal. </h2>
        {% endif %}
        <h3>{{ horse.grain_type }} </h3>
        <p> {{ horse.description }} </p>
        <div class="horse-actions">
            <a href="{% url 'horse-update' horse.id %}" class="btn warn">Edit</a>
            <a href="{% url 'horse-delete' horse.id %}" class="btn danger">Delete</a>
        </div>
    </div>
</section>

<div class="feedings-trainings-container">
    <section class="feedings">
        <div class="subsection-title">
            <h2>Feedings</h2>
            <!-- <img src="" alt=""> -->
        </div>

        <h3>Add a Feeding</h3>
        <form action="{% url 'add-feeding' horse.id %}" method="post" class="subsection-content" autocomplete="off">
            {% csrf_token %}
            {{ feeding_form.as_p }}
            <button type="submit" class="btn submit">Add Feeding</button>
        </form>
        <table>
            <h3>Past Feedings</h3>

            {% if horse.feeding_set.all.count %}
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Time</th>
                    <th>Grain Type</th>
                </tr>
            </thead>
            <tbody>
                {% for feeding in horse.feeding_set.all %}
                <tr>
                    <td>{{ feeding.date }}</td>
                    <td>{{ feeding.get_time_display }}</td>
                    <td>{{ feeding.get_grain_type_display }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <div class="subsection-content">
            <p>⚠️ {{horse.name}} has not been fed!</p>
        </div>
    </section>



    <section class="trainings">
        <div class="subsection-title">
            <h2>Trainings</h2>
            <img src="" alt="">
        </div>
        <h3>{{ horse.name }}'s Trainings</h3>
        <div class="subsection-content">
            {% if horse.trainings.count %}
            {% for training in horse.trainings.all %}
            <div class="training-container">
                <div class="color-block" style="background-color: blueviolet;"></div>
                <a href="{% url 'training-detail' training.id %}">
                <p>Let's do some {{ training.discipline }} at {{ training.location }} today.</p>
                </a>
                <form action="{% url 'associate-training' horse.id training.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="btn submit">Ride!</button>
                </form>
            </div>
            {% endfor %}
            {% else %}
            <p class="no-trainings">{{ horse.name }} doesn't have any training!</p>
            {% endif %}
        </div>
        <h3>Available Trainings</h3>
        <div class="subsection-content">
            {% if trainings.count %}
            {% for training in trainings.all %}
            <div class="training-container">
                <div class="color-block" style="background-color: aquamarine;"></div>
                <a href="{% url 'training-detail' training.id %}">
                    <p>A {{ training.discipline }} ride at {{ training.location }}</p>
                </a>
                <form action="{% url 'associate-training' horse.id training.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="btn submit"></button>
                </form>
            </div>
            {% endfor %}
            {% else %}
                <p class="all-trainings">{{ horse.name }} already trained.</p>
            {% endif %}
        </div>
    </section>
</div>
{% endif %}
{% endblock content %}